---
// import { Icon } from "astro-icon/components";
import CardService from "./CardService.astro";

interface Service {
  title: string;
  description: string;
  image: string;
  colorClass: string; // Clase de Tailwind para el color
  center?: boolean;
  features: {
    title: string;
    description?: string;
    icon: string;
  }[];
}
export const services: Service[] = [
    {
      title: "Estrategia y Consultoría",
      description: "Acompañamos a nuestros clientes en el diseño de modelos de ciberseguridad, resiliencia y cumplimiento.",
      image: "/images/servicios/estrategia.jpeg",
      colorClass: "white",
      center:true,
      features: [
        {
          title: "Diseño de estrategias de continuidad de negocio",
          // description: "Desarrollamos planes integrales para garantizar la operación continua de tu organización ante cualquier contingencia",
          icon: "M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
        },
        {
          title: "Obtención y mantenimiento de certificaciones",
          // description: "Te acompañamos en el proceso de certificación y mantenimiento de estándares internacionales de calidad y seguridad",
          icon: "M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
        },
        {
          title: "Consultoría de arquitectura",
          // description: "Diseñamos arquitecturas robustas y escalables que se adaptan a las necesidades actuales y futuras de tu organización",
          icon: "M13 10V3L4 14h7v7l9-11h-7z"
        }
      ]
    },
    {
      title: "Arquitectura e Integración",
      description: "Traducimos la estrategia en soluciones tangibles con tecnología de punta.",
      image: "/images/servicios/arquitectura.jpeg",
      colorClass: "white",
      center:true,
      features: [
        {
          title: "Diseño e implementación de arquitecturas",
          // description: "Desarrollamos arquitecturas robustas y escalables que se adaptan a las necesidades específicas de tu organización",
          icon: "M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"
        },
        {
          title: "Integración de soluciones de ciberseguridad",
          // description: "Implementamos y configuramos herramientas de ciberseguridad avanzadas para proteger tu infraestructura",
          icon: "M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"
        },
        {
          title: "Diseño e integración de redes seguras",
          // description: "Construimos redes seguras y optimizadas que garantizan la conectividad y protección de tus datos",
          icon: "M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"
        },
        {
          title: "Arquitectura e integración de data center",
          // description: "Diseñamos y optimizamos centros de datos para maximizar eficiencia, seguridad y disponibilidad",
          icon: "M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
        }
      ]
    },
    {
      title: "Servicios Gestionados",
      description: "Brindamos continuidad, visibilidad y control mediante la gestión proactiva.",
      image: "/images/servicios/serv-gestionados.jpeg",
      colorClass: "white",
      center:true,
      features: [
        {
          title: "CYBERSOC",
          // description: "Centro de operaciones de seguridad cibernética para monitoreo y respuesta 24/7",
          icon: "M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
        },
        {
          title: "Gestión de incidentes de ciberseguridad",
          // description: "Respuesta rápida y efectiva ante amenazas y incidentes de seguridad con protocolos especializados",
          icon: "M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"
        },
        {
          title: "Service Desk",
          // description: "Soporte técnico especializado para resolver incidencias y consultas de manera eficiente",
          icon: "M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
        },
        {
          title: "Monitoreo gestionado de amenazas",
          // description: "Vigilancia continua y análisis proactivo de amenazas para proteger tu infraestructura",
          icon: "M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"
        }
      ]
    },
    {
      title: "Formación",
      description: "Competencias para la evolución.",
      image: "/images/servicios/formacion.jpeg",
      colorClass: "white",
      features: [
        {
          title: "Capacitación",
          description: "Capacitar a los clientes para que usen, gestionen y aprovechen al máximo las soluciones implementadas o de su entorno de TI y seguridad",
          icon: "M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
        },
        {
          title: "Presentación",
          description: "Atraer, educar e interesar a potenciales clientes a través de experiencias formativas que les muestre el valor de las soluciones y el conocimiento asociado",
          icon: "M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"
        }
      ]
    }
  ];


---

<section id="servicios" class="py-24 relative overflow-hidden">
  <div class="w-full relative z-10">
    <div
      data-aos="fade-up" 
      data-aos-duration="1200" 
      data-aos-delay="200"
      class="text-center md:mb-16"
    >
      <h2 class="font-stolzl servicios-titulo text-3xl md:text-5xl font-bold text-white mb-4 tracking-tight">
        Nuestros Servicios
      </h2>
      <p class="servicios-subtitulo text-lg md:text-xl text-white/70 max-w-2xl mx-auto">
        Soluciones integrales diseñadas para impulsar tu transformación digital.
      </p>
    </div>
    
    <div class="scroll-section vertical-section section mt-[-150px]">
      <div class="wrapper">
        <div role="list" class="list">
          {
            services.map((service, index) => (
              <CardService
                index={index +1} 
                title={service.title} 
                description={service.description} 
                imageUrl={service.image}
                colorClass={service.colorClass}
                features={service.features}
                center={service.center}
              />
            ))
          }
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .section {
    overflow: hidden;
  }

  .wrapper {
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding-top: 120px; /* Añade espacio arriba para el header */
    width: 100vw; /* Ocupar todo el ancho del viewport */
    margin: 0; /* Eliminar márgenes */
  }

  .list {
    justify-content: center;
    align-items: center;
    height: 100%;
    display: flex;
    position: relative;
    padding: 0; /* Eliminar padding */
    width: 100vw; /* Ocupar todo el ancho del viewport */
    margin: 0; /* Eliminar márgenes */
  }

  .padding-global {
    padding-left: 2.5rem;
    padding-right: 2.5rem;
  }

  .padding-vertical {
    padding: 2rem;
  }

  @media (max-width: 575.98px) {
    .heading {
      font-size: 2.5rem;
    }
  }
</style>


<!-- Efecto de stack card -->
<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  // Registrar plugin
  gsap.registerPlugin(ScrollTrigger);

  // Seleccionar las secciones
  const scrollSections =
    document.querySelectorAll<HTMLElement>(".scroll-section");

  scrollSections.forEach((section) => {
    const wrapper = section.querySelector<HTMLElement>(".wrapper");
    const items = wrapper?.querySelectorAll<HTMLElement>(".item");

    if (!wrapper || !items || items.length === 0) return;

    let direction: "horizontal" | "vertical" | null = null;

    if (section.classList.contains("vertical-section")) {
      direction = "vertical";
    } else if (section.classList.contains("horizontal-section")) {
      direction = "horizontal";
    }

    if (direction) {
      initScroll(section, items, direction);
    }
  });

  function initScroll(
    section: HTMLElement,
    items: NodeListOf<HTMLElement>,
    direction: "horizontal" | "vertical"
  ) {
    // Estado inicial - Todas las tarjetas excepto la primera ya están escaladas a 0.8
    items.forEach((item, index) => {
      if (index !== 0) {
        direction === "horizontal"
          ? gsap.set(item, { xPercent: 100 })
          : gsap.set(item, { yPercent: 100 });
      }
    });

    const timeline = gsap.timeline({
      scrollTrigger: {
        trigger: section,
        pin: true,
        start: "top top",
        end: () => `+=${items.length * 100}%`,
        scrub: 1,
        invalidateOnRefresh: true,
        // markers: true,
      },
      defaults: { ease: "none" },
    });

    items.forEach((item, index) => {
      timeline.to(item, {
        scale: 0.7, // Escala un poco más pequeña al hacer scroll
        // borderRadius: "10px",
      });

      const nextItem = items[index + 1];
      if (!nextItem) return;

      direction === "horizontal"
        ? timeline.to(
            nextItem,
            {
              xPercent: 0,
            },
            "<"
          )
        : timeline.to(
            nextItem,
            {
              yPercent: 0,
            },
            "<"
          );
    }); 
  }
</script>


<!-- Efecto Oscurecer -->
<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";
    gsap.registerPlugin(ScrollTrigger);
  
    document.addEventListener("DOMContentLoaded", () => {
      // Guarda el color de fondo original del body
      const originalColor = window.getComputedStyle(document.body).backgroundColor;
      
      // Selecciona el componente de identidad
      const identidadSection = document.querySelector('#identidad');
  
      ScrollTrigger.create({
        trigger: '#servicios',
        start: 'top 50%',
        end: '+=80% 0%',
        markers: false,
        onEnter: () => {
          // Al entrar, cambia el color del body
          gsap.to(document.body, {
            backgroundColor: '#050835',
            duration: 0.5,
          });
          
          // Cambia el fondo del componente de identidad al color de servicios
          if (identidadSection) {
            identidadSection.classList.add('transparent-mode');
          }
        },
        onLeave: () => {
          // Al salir por abajo, vuelve al color original
          gsap.to(document.body, {
            backgroundColor: originalColor,
            duration: 0.5,
          });
          
          // Restaura el degradado del componente de identidad
          if (identidadSection) {
            identidadSection.classList.remove('transparent-mode');
          }
        },
        onEnterBack: () => {
          // Al entrar de nuevo (scrolling hacia arriba), cambia al color oscuro
          gsap.to(document.body, {
            backgroundColor: '#050835',
            duration: 0.5,
          });
          
          // Cambia el fondo del componente de identidad al color de servicios
          if (identidadSection) {
            identidadSection.classList.add('transparent-mode');
          }
        },
        onLeaveBack: () => {
          // Al salir por arriba, vuelve al color original
          gsap.to(document.body, {
            backgroundColor: originalColor,
            duration: 0.5,
          });
          
          // Restaura el degradado del componente de identidad
          if (identidadSection) {
            identidadSection.classList.remove('transparent-mode');
          }
        }
      });
    });
</script>

---
// Hero component
---

<section
  class="hero-section relative min-h-screen flex items-center justify-center overflow-hidden"
>
  <!-- Carrusel de im√°genes de fondo -->
  <div class="absolute inset-0 w-full h-full">
    <div class="hero-carousel w-full h-full relative overflow-hidden">
      <!-- Imagen 1 -->
      <div class="hero-slide slide-1 absolute inset-0 w-full h-full opacity-100 transition-opacity duration-1000 ease-in-out">
        <img
          src="/images/Hero/hero1.webp"
          alt="Hero background 1"
          class="w-full h-full object-cover"
        />
      </div>
      
      <!-- Imagen 2 -->
      <div class="hero-slide slide-2 absolute inset-0 w-full h-full opacity-0 transition-opacity duration-1000 ease-in-out">
        <img
          src="/images/Hero/hero2.webp"
          alt="Hero background 2"
          class="w-full h-full object-cover"
        />
      </div>
      
      <!-- Imagen 3 -->
      <div class="hero-slide slide-3 absolute inset-0 w-full h-full opacity-0 transition-opacity duration-1000 ease-in-out">
        <img
          src="/images/Hero/hero3.webp"
          alt="Hero background 3"
          class="w-full h-full object-cover"
        />
      </div>
    </div>

    <!-- Overlay oscuro para mejor legibilidad -->
    <div class="hero-overlay absolute inset-0 bg-black/70 z-10"></div>
  </div>

  <div class="container mx-auto px-4 pt-24 text-center relative z-20">
    <!-- T√≠tulo principal rotativo -->
    <h1 class="hero-title text-6xl md:text-8xl font-bold text-white mb-6">
      <div
        class="rotating-title-container relative h-24 md:h-32 overflow-hidden"
      >
        <div class="rotating-titles absolute inset-0">
          <!-- T√≠tulo 1 -->
          <div
            class="font-stolzl rotating-title title-1 absolute inset-0 flex items-center justify-center gap-4"
          >
            <span
              class="hero-word word-1"
              style="opacity: 0; transform: translateY(50px);">Protecci√≥n</span
            >
            <span
              class="hero-word word-2"
              style="opacity: 0; transform: translateY(50px);">inteligente</span
            >
          </div>

          <!-- T√≠tulo 2 -->
          <div
            class="font-stolzl rotating-title title-2 absolute inset-0 flex items-center justify-center gap-4"
          >
            <span
              class="hero-word word-1"
              style="opacity: 0; transform: translateY(50px);">Excelencia</span
            >
            <span
              class="hero-word word-2"
              style="opacity: 0; transform: translateY(50px);">tecnol√≥gica</span
            >
          </div>

          <!-- T√≠tulo 3 -->
          <div
            class="font-stolzl rotating-title title-3 absolute inset-0 flex items-center justify-center gap-4"
          >
            <span
              class="hero-word word-1"
              style="opacity: 0; transform: translateY(50px);">Innovaci√≥n</span
            >
            <span
              class="hero-word word-2"
              style="opacity: 0; transform: translateY(50px);">segura</span
            >
          </div>
        </div>
      </div>
    </h1>

    <!-- Subt√≠tulo -->
    <p
      class="hero-subtitle text-xl md:text-2xl text-white/90 mb-8 max-w-3xl mx-auto"
      style="opacity: 0; transform: translateY(30px);"
    >
      Construimos el futuro digital con soluciones innovadoras y tecnolog√≠a de
      vanguardia
    </p>

    <!-- Botones de acci√≥n -->
    <div
      class="hero-buttons flex flex-col sm:flex-row gap-4 justify-center items-center"
      style="opacity: 0; transform: translateY(20px);"
    >
      <button
        class="btn-primary px-8 py-4 bg-secondary text-white rounded-full font-semibold text-lg hover:bg-white hover:text-secondary transition-all duration-300 transform hover:scale-105"
      >
        Nuestros servicios
      </button>
      <button
        class="btn-secondary px-8 py-4 border-2 border-white text-white rounded-full font-semibold text-lg hover:bg-white hover:text-dark transition-all duration-300 transform hover:scale-105 shadow-lg"
      >
        Cont√°ctanos
      </button>
    </div>
  </div>

  <!-- Indicador de scroll -->
  <div
    class="scroll-indicator absolute bottom-8 left-1/2 transform -translate-x-1/2 z-20"
    style="opacity: 0; transform: translate(-50%, 20px);"
  >
    <div
      class="w-6 h-10 border-2 border-white rounded-full flex justify-center"
    >
      <div class="scroll-dot w-1 h-3 bg-white rounded-full mt-2 animate-bounce">
      </div>
    </div>
  </div>
</section>

<script>
  // Variables globales para el t√≠tulo rotativo
  let currentTitleIndex = 0;
  let isAnimating = false;
  const titles = [
    { words: ["Protecci√≥n", "inteligente"] },
    { words: ["Excelencia", "tecnol√≥gica"] },
    { words: ["Innovaci√≥n", "segura"] },
  ];

  // Variables globales para el carrusel de im√°genes
  let currentSlideIndex = 0;
  let isSlideAnimating = false;
  let slides;
  let totalSlides;
  let imageCarouselInterval;

  // Funci√≥n para animar el t√≠tulo rotativo
  function animateRotatingTitle() {
    if (isAnimating) return;
    isAnimating = true;

    const currentTitle = document.querySelector(
      `.title-${currentTitleIndex + 1}`
    );
    const nextTitleIndex = (currentTitleIndex + 1) % titles.length;
    const nextTitle = document.querySelector(`.title-${nextTitleIndex + 1}`);

    if (currentTitle && nextTitle) {
      // Animar salida del t√≠tulo actual
      const currentWords = currentTitle.querySelectorAll(".hero-word");
      currentWords.forEach((word, index) => {
        setTimeout(() => {
          word.style.transform = "translateY(-50px)";
          word.style.opacity = "0";
        }, index * 100);
      });

      // Despu√©s de la animaci√≥n de salida, cambiar al siguiente t√≠tulo
      setTimeout(() => {
        // Ocultar t√≠tulo actual
        currentTitle.style.display = "none";

        // Mostrar y animar siguiente t√≠tulo
        nextTitle.style.display = "flex";
        const nextWords = nextTitle.querySelectorAll(".hero-word");

        // Resetear estado inicial
        nextWords.forEach((word) => {
          word.style.transform = "translateY(50px)";
          word.style.opacity = "0";
        });

        // Animar entrada
        nextWords.forEach((word, index) => {
          setTimeout(() => {
            word.style.transform = "translateY(0)";
            word.style.opacity = "1";
          }, index * 150);
        });

        currentTitleIndex = nextTitleIndex;
        isAnimating = false;
      }, 500);
    }
  }

  // Funci√≥n para animar el carrusel de im√°genes
  function animateImageCarousel() {
    if (isSlideAnimating || totalSlides <= 1) return;
    isSlideAnimating = true;

    // Calcular siguiente slide
    const nextSlideIndex = (currentSlideIndex + 1) % totalSlides;
    const currentSlide = slides[currentSlideIndex];
    const nextSlide = slides[nextSlideIndex];

    if (currentSlide && nextSlide) {
      // Preparar la siguiente imagen (opacidad 0 pero visible)
      nextSlide.style.opacity = '0';
      nextSlide.style.zIndex = '2';
      currentSlide.style.zIndex = '1';

      // Animar el crossfade
      let startTime = null;
      const duration = 1000; // 1 segundo para la transici√≥n

      function crossfade(timestamp) {
        if (!startTime) startTime = timestamp;
        const progress = Math.min((timestamp - (startTime || 0)) / duration, 1);
        
        // Easing suave
        const easeProgress = 1 - Math.pow(1 - progress, 3);
        
        // Actualizar opacidades
        currentSlide.style.opacity = 1 - easeProgress;
        nextSlide.style.opacity = easeProgress;
        
        if (progress < 1) {
          requestAnimationFrame(crossfade);
        } else {
          // Transici√≥n completada
          currentSlide.style.zIndex = '0';
          nextSlide.style.zIndex = '1';
          currentSlideIndex = nextSlideIndex;
          isSlideAnimating = false;
        }
      }

      requestAnimationFrame(crossfade);
    }
  }

  // Funci√≥n para reiniciar el temporizador del carrusel
  function resetImageCarouselTimer() {
    // Limpiar el intervalo anterior si existe
    if (imageCarouselInterval) {
      clearInterval(imageCarouselInterval);
    }
    
    // Crear un nuevo intervalo
    imageCarouselInterval = setInterval(animateImageCarousel, 5000); // 5 segundos
  }

  // Funci√≥n para manejar el click en el hero
  function handleHeroClick(event) {
    // Verificar si el click fue en texto o botones
    const clickedElement = event.target;
    const isTextElement = clickedElement.closest('.hero-title, .hero-subtitle, .hero-buttons, .scroll-indicator');
    
    // Si no es un elemento de texto o bot√≥n, cambiar imagen y reiniciar temporizador
    if (!isTextElement) {
      animateImageCarousel();
      resetImageCarouselTimer(); // Reiniciar el temporizador despu√©s del click
    }
  }

  // Funci√≥n para animar elementos del hero con CSS puro
  function animateHeroElements() {
    const subtitle = document.querySelector(".hero-subtitle");
    const buttons = document.querySelector(".hero-buttons");
    const scrollIndicator = document.querySelector(".scroll-indicator");

    // Animar primer t√≠tulo
    const firstTitle = document.querySelector(".title-1");
    if (firstTitle) {
      firstTitle.style.display = "flex";
      const words = firstTitle.querySelectorAll(".hero-word");
      words.forEach((word, index) => {
        setTimeout(
          () => {
            word.style.transform = "translateY(0)";
            word.style.opacity = "1";
          },
          300 + index * 250
        );
      });
    }

    // Ocultar otros t√≠tulos
    for (let i = 2; i <= 3; i++) {
      const title = document.querySelector(`.title-${i}`);
      if (title) {
        title.style.display = "none";
      }
    }

    if (subtitle) {
      subtitle.style.transform = "translateY(50px)";
      subtitle.style.opacity = "0";
      subtitle.style.transition = "all 1.2s ease-out";
    }

    if (buttons) {
      buttons.style.transform = "translateY(50px)";
      buttons.style.opacity = "0";
      buttons.style.transition = "all 1.0s ease-out";
    }

    if (scrollIndicator) {
      scrollIndicator.style.transform = "translateY(30px)";
      scrollIndicator.style.opacity = "0";
      scrollIndicator.style.transition = "all 0.8s ease-out";
    }

    // Animar otros elementos con timing m√°s elegante
    setTimeout(() => {
      if (subtitle) {
        subtitle.style.transform = "translateY(0)";
        subtitle.style.opacity = "1";
      }
    }, 1400);

    setTimeout(() => {
      if (buttons) {
        buttons.style.transform = "translateY(0)";
        buttons.style.opacity = "1";
      }
    }, 1800);

    setTimeout(() => {
      if (scrollIndicator) {
        scrollIndicator.style.transform = "translateY(0)";
        scrollIndicator.style.opacity = "1";
      }
    }, 2200);

    // Iniciar rotaci√≥n de t√≠tulos despu√©s de 4 segundos
    setTimeout(() => {
      setInterval(animateRotatingTitle, 4000);
    }, 4000);

    // Iniciar carrusel de im√°genes despu√©s de 3 segundos
    setTimeout(() => {
      resetImageCarouselTimer(); // Usar la funci√≥n para inicializar el temporizador
    }, 3000);
  }

  // Formas flotantes eliminadas

  // Funci√≥n principal de inicializaci√≥n
  function initHeroAnimations() {
    // Inicializar variables del carrusel
    slides = document.querySelectorAll('.hero-slide');
    totalSlides = slides.length;

    // Asegurar que la primera imagen tenga el z-index correcto (por debajo del overlay)
    if (slides.length > 0) {
      slides[0].style.zIndex = '1';
    }

    // A√±adir event listener para click en el hero
    const heroSection = document.querySelector('.hero-section');
    if (heroSection) {
      heroSection.addEventListener('click', handleHeroClick);
    }

    // Intentar usar GSAP si est√° disponible
    if (typeof gsap !== "undefined" && window.gsapReady) {
      console.log("üé¨ Usando GSAP para animaciones del Hero");

      // Timeline principal del hero
      const heroTimeline = gsap.timeline();

      // Formas flotantes eliminadas

      // Animaci√≥n del primer t√≠tulo con stagger m√°s lento y elegante
      const firstTitle = document.querySelector(".title-1");
      if (firstTitle) {
        firstTitle.style.display = "flex";
        const firstWords = firstTitle.querySelectorAll(".hero-word");

        heroTimeline
          .from(firstWords, {
            y: 100,
            opacity: 0,
            duration: 1.5,
            stagger: 0.25,
            ease: "power2.out",
          })
          .from(
            ".hero-subtitle",
            {
              y: 50,
              opacity: 0,
              duration: 1.2,
              ease: "power2.out",
            },
            "-=0.8"
          );
      }

      // Ocultar otros t√≠tulos
      for (let i = 2; i <= 3; i++) {
        const title = document.querySelector(`.title-${i}`);
        if (title) {
          title.style.display = "none";
        }
      }

      // Continuar con el timeline
      heroTimeline
        .from(
          ".hero-buttons",
          {
            y: 50,
            opacity: 0,
            duration: 1.0,
            ease: "power2.out",
          },
          "-=0.6"
        )
        .from(
          ".scroll-indicator",
          {
            y: 30,
            opacity: 0,
            duration: 0.8,
            ease: "power2.out",
          },
          "-=0.4"
        );

      // Iniciar rotaci√≥n de t√≠tulos despu√©s de 4 segundos
      setTimeout(() => {
        setInterval(animateRotatingTitle, 4000);
      }, 4000);

      // Iniciar carrusel de im√°genes despu√©s de 3 segundos
      setTimeout(() => {
        resetImageCarouselTimer(); // Usar la funci√≥n para inicializar el temporizador
      }, 3000);

      // Parallax eliminado - formas flotantes removidas

      // Animaci√≥n del indicador de scroll
      gsap.to(".scroll-dot", {
        y: 12,
        duration: 1.5,
        repeat: -1,
        ease: "power2.inOut",
      });
    } else {
      console.log("üé® Usando CSS puro para animaciones del Hero");
      animateHeroElements();
    }
  }

  // Iniciar animaciones cuando GSAP est√© listo o despu√©s de que termine el loader
  function startHeroAnimations() {
    // M√ÅXIMA VELOCIDAD - Hero aparece s√∫per r√°pido (0.9s)
    setTimeout(() => {
      if (window.gsapReady && typeof gsap !== "undefined") {
        initHeroAnimations();
      } else {
        // Fallback con CSS inmediato
        setTimeout(initHeroAnimations, 20);
      }
    }, 900);
  }

  // Verificar si GSAP ya est√° listo
  if (window.gsapReady) {
    startHeroAnimations();
  } else {
    // Escuchar cuando GSAP est√© listo
    window.addEventListener("gsapReady", startHeroAnimations);

    // Fallback: si GSAP no carga, usar CSS - M√ÅXIMA VELOCIDAD
    setTimeout(startHeroAnimations, 1100);
  }
</script>

<style>
  .hero-section {
    background: linear-gradient(135deg, #eaeaea 0%, #ffffff 50%, #eaeaea 100%);
  }

  /* Estilos para el carrusel de im√°genes */
  .hero-carousel {
    position: relative;
  }

  .hero-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  .hero-slide img {
    object-fit: cover;
    object-position: center;
    width: 100%;
    height: 100%;
  }

  /* Estilos para el t√≠tulo rotativo */
  .rotating-title-container {
    perspective: 1000px;
  }

  .rotating-title {
    transition: all 0.6s ease-in-out;
  }

  .hero-word {
    transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    white-space: nowrap;
  }

  /* Espaciado mejorado para las palabras */
  .rotating-title .hero-word:not(:last-child) {
    margin-right: 1rem;
  }

  @media (max-width: 768px) {
    .rotating-title .hero-word:not(:last-child) {
      margin-right: 0.5rem;
    }
  }

  /* Formas flotantes eliminadas */

  /* Efectos hover para botones */
  .btn-primary:hover {
    /* Sin sombra para mejor visibilidad sobre fondo oscuro */
  }

  .btn-secondary:hover {
    box-shadow: 0 10px 25px rgba(255, 255, 255, 0.3);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .hero-title {
      font-size: 3rem;
      line-height: 1.2;
    }

    .hero-subtitle {
      font-size: 1.125rem;
    }

    .rotating-title-container {
      height: 6rem;
    }
  }

  /* Mejoras para el overlay */
  .hero-overlay {
    backdrop-filter: blur(1px);
    z-index: 10;
  }

  /* Animaci√≥n suave para el scroll indicator */
  .scroll-indicator {
    transition: all 0.3s ease;
  }
</style>
